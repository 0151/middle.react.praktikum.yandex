(this["webpackJsonpreact-messenger"]=this["webpackJsonpreact-messenger"]||[]).push([[0],{20:function(e){e.exports=JSON.parse('{"0d3536c0-8589-44d8-ba45-bd3d679205b3":"\u0411\u0435\u043b\u043e\u0437\u0451\u0440\u043e\u0432 \u0416\u0435\u0440\u0430\u0440","08432463-79a1-4576-a2cd-73c5aeb6915c":"\u0411\u0443\u0442\u043a\u043e \u0421\u0435\u043c\u0451\u043d","0aa3312e-cf77-4be9-b53a-a985e842c033":"\u0427\u0438\u043a\u043e\u043b\u044c\u0431\u0430 \u0414\u0430\u0440\u044c\u044f","68c7856c-9638-45a3-8e66-84e8dc396163":"\u041f\u043e\u043b\u044f\u043a\u043e\u0432 \u0427\u0430\u0440\u043b\u044c\u0437"}')},30:function(e){e.exports=JSON.parse('[{"chatId":"45bde386-9426-11ea-bb37-0242ac130002","users":["0d3536c0-8589-44d8-ba45-bd3d679205b3"]},{"chatId":"45bde732-9426-11ea-bb37-0242ac130002","users":["08432463-79a1-4576-a2cd-73c5aeb6915c"]},{"chatId":"45bdf1a0-9426-11ea-bb37-0242ac130002","users":["0aa3312e-cf77-4be9-b53a-a985e842c033"]},{"chatId":"45bdf2c2-9426-11ea-bb37-0242ac130002","users":["68c7856c-9638-45a3-8e66-84e8dc396163"]}]')},31:function(e){e.exports=JSON.parse('{"45bde386-9426-11ea-bb37-0242ac130002":[{"messageId":"278008dc-9452-11ea-bb37-0242ac130002","timestamp":"2012-04-23T18:25:43.511Z","text":"\u041f\u0440\u0438\u043a\u0438\u043d\u044c, \u0441\u043e\u043d \u043f\u0440\u0438\u0441\u043d\u0438\u043b\u0441\u044f, \u0447\u0442\u043e \u0443 \u043c\u0435\u043d\u044f \u0447\u0435\u0442\u0432\u0435\u0440\u043e \u0434\u0435\u0442\u0435\u0439","author":"0d3536c0-8589-44d8-ba45-bd3d679205b3"},{"messageId":"27800b3e-9452-11ea-bb37-0242ac130002","timestamp":"2012-04-23T18:25:43.511Z","text":"\u0418 \u0432\u0441\u0435 \u043d\u0430 \u0434\u0438\u0441\u0442\u0430\u043d\u0446\u0438\u043e\u043d\u043d\u043e\u043c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438!","author":"0d3536c0-8589-44d8-ba45-bd3d679205b3"},{"messageId":"e85812b4-96a7-11ea-bb37-0242ac130002","timestamp":"2013-04-23T18:25:43.511Z","text":"\u041d\u0430\u043a\u043e\u043d\u0435\u0446-\u0442\u043e \u043f\u043e\u043f\u0430\u043b\u0441\u044f \u043e\u0442\u043b\u0438\u0447\u043d\u044b\u0439 \u0444\u0438\u043b\u044c\u043c \u0411\u043e\u043d\u0434\u0430\u0440\u0447\u0443\u043a\u0430! \u0421\u043c\u043e\u0442\u0440\u0435\u043b \u0438 \u043d\u0430\u0441\u043b\u0430\u0436\u0434\u0430\u043b\u0441\u044f. \u041a\u0441\u0442\u0430\u0442\u0438, \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u044e - \xab\u0412\u043e\u0439\u043d\u0430 \u0438 \u043c\u0438\u0440\xbb 1967 \u0433\u043e\u0434\u0430","author":"a2d451ac-1c55-49ee-95e4-a1eca43520c7"}],"45bde732-9426-11ea-bb37-0242ac130002":[{"messageId":"27800cd8-9452-11ea-bb37-0242ac130002","timestamp":"2012-04-23T18:25:43.511Z","text":"\u0410 \u043c\u043e\u0436\u0435\u0442, \u0443\u0434\u0430\u043b\u0438\u0442\u044c 2020 \u0438 \u0441\u043d\u043e\u0432\u0430 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c? \u0410 \u0442\u043e \u044d\u0442\u0430 \u0432\u0435\u0440\u0441\u0438\u044f \u0441 \u0432\u0438\u0440\u0443\u0441\u043e\u043c","author":"08432463-79a1-4576-a2cd-73c5aeb6915c"}],"45bdf1a0-9426-11ea-bb37-0242ac130002":[{"messageId":"27800df0-9452-11ea-bb37-0242ac130002","timestamp":"2012-04-23T18:25:43.511Z","text":"\u041c\u043e\u0435\u043c\u0443 \u0441\u044b\u043d\u0443 \u043f\u043e \u0444\u0438\u0437\u043e \u043f\u0440\u0438\u0441\u043b\u0430\u043b\u0438: \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u0435 \u043d\u0430 \u043f\u043b\u0435\u0447\u0435\u0432\u043e\u0439 \u043f\u043e\u044f\u0441 \u0441\u0442\u043e\u043b\u044c\u043a\u043e-\u0442\u043e \u0440\u0430\u0437, \u043f\u0440\u0438\u0441\u043b\u0430\u0442\u044c \u0432\u0438\u0434\u0435\u043e","author":"0aa3312e-cf77-4be9-b53a-a985e842c033"},{"messageId":"27800f4e-9452-11ea-bb37-0242ac130002","timestamp":"2012-04-23T18:25:43.511Z","text":"\u042f \u0433\u043e\u0432\u043e\u0440\u044e - \u0441\u0434\u0435\u043b\u0430\u0439 \u0433\u0438\u0444\u043a\u0443, \u043f\u0443\u0441\u0442\u044c \u0441\u0447\u0438\u0442\u0430\u044e\u0442","author":"0aa3312e-cf77-4be9-b53a-a985e842c033"}],"45bdf2c2-9426-11ea-bb37-0242ac130002":[{"messageId":"2780102a-9452-11ea-bb37-0242ac130002","timestamp":"2012-04-23T18:25:43.511Z","text":"\u041e\u0439! \u0410 \u044f \u0442\u0435\u0431\u044f \u0431\u0435\u0437 \u043c\u0430\u0441\u043a\u0438 \u0438 \u043d\u0435 \u0443\u0437\u043d\u0430\u043b\u0430!","author":"68c7856c-9638-45a3-8e66-84e8dc396163"}]}')},35:function(e,t,a){e.exports=a(71)},41:function(e,t,a){},56:function(e,t,a){},58:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},70:function(e,t,a){},71:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(28),c=a.n(s),o=a(17),i=a(4),l=a(5),u=a(7),d=a(6),m=a(12),h=a(11),b=a(2),p=a(15),f=a(14),v=(a(41),function(e){var t=Object(f.cn)("input"),a=e.error,n=(e.className,Object(p.a)(e,["error","className"])),s=t({invalid:!!a});return r.a.createElement("div",{className:s},r.a.createElement("input",Object.assign({className:"input__control"},n)),a&&r.a.createElement("div",{className:"input__error"},a))}),g=a(29),E=a.n(g),y=(a(56),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={backgroundImage:"none"},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;new E.a({accessKey:"JR9JeEu0NHDn3d6fuH_fPLUlKWMWKdbJzaIF7eXv6xM"}).photos.getRandomPhoto({collections:["446755"]}).then((function(e){return e.json()})).then((function(t){t.errors&&!t.errors.length&&e.setState({backgroundImage:t.urls.regular})})).catch((function(e){return console.error(e)}))}},{key:"render",value:function(){var e={backgroundImage:"url(".concat(this.state.backgroundImage,")")};return r.a.createElement("div",{className:"wrapper",style:e},r.a.createElement("div",{className:"auth"},r.a.createElement("div",{className:"auth__header"},r.a.createElement("span",{className:"auth__title"},this.props.title)),r.a.createElement("div",{className:"auth__content"},this.props.children)))}}]),a}(n.PureComponent)),O=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={fields:{login:"demo",password:"demo"},errors:{}},e.setError=function(t,a){e.setState((function(e){return{errors:Object(b.a)(Object(b.a)({},e.errors),{},Object(h.a)({},t,a))}}))},e.unsetError=function(t){e.setState((function(e){var a=Object(b.a)({},e.errors);return delete a[t],{errors:a}}))},e.handleInputChange=function(t){var a=t.target,n=a.name,r=a.value;e.unsetError(n),e.setState((function(e){return{fields:Object(b.a)(Object(b.a)({},e.fields),{},Object(h.a)({},n,r))}}))},e.validateLogin=function(){"demo"!==e.state.fields.login&&e.setError("login","\u0422\u0430\u043a\u043e\u0433\u043e \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 \u043d\u0435\u0442")},e.handleSubmit=function(t){if(t.preventDefault(),0===Object.keys(e.state.errors).length){var a=e.props,n=a.history,r=a.submitCallback,s=e.state.fields,c=s.login,o=s.password;"demo"===c&&"demo"===o?(r("a2d451ac-1c55-49ee-95e4-a1eca43520c7"),n.push("/chat")):e.setError("password","\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c")}},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.history;return r.a.createElement(y,{title:"\u0412\u043e\u0439\u0434\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-field"},r.a.createElement(v,{name:"login",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d",onChange:this.handleInputChange,onBlur:this.validateLogin,value:this.state.fields.login,error:"login"in this.state.errors?this.state.errors.login:""})),r.a.createElement("div",{className:"form-field"},r.a.createElement(v,{name:"password",type:"password",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",onChange:this.handleInputChange,value:this.state.fields.password,error:"password"in this.state.errors?this.state.errors.password:""})),r.a.createElement("button",{className:"button",type:"submit"},"\u0412\u043e\u0439\u0442\u0438"),r.a.createElement("button",{className:"button button_view_pseudo",onClick:function(){e.push("/registration")}},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")))}}]),a}(n.PureComponent),j=a(34),N=a(73),w=a(8),_=a.n(w),C=(a(58),a(59),function(e){var t=e.src,a=e.alt;return r.a.createElement("div",{className:"avatar"},t&&r.a.createElement("img",{className:"avatar__image",src:t,alt:a}))}),I=function(e){var t=Object(f.cn)("chat-entity"),a=e.chatId,n=e.timestamp,s=e.name,c=e.text,o=e.isSelected,i=e.handleChatSelect,l=_()(n).format("DD.MM.YYYY"),u=t({selected:o});return r.a.createElement("li",{className:u,onClick:i(a)},r.a.createElement("div",{className:"chat-entity__prepend"},r.a.createElement(C,null)),r.a.createElement("div",{className:"chat-entity__body"},r.a.createElement("div",{className:"chat-entity__horizontal-layout"},r.a.createElement("div",{className:"chat-entity__header"},s),r.a.createElement("div",{className:"chat-entity__date"},l)),c&&r.a.createElement("div",{className:"chat-entity__text"},c)))},x=(a(60),function(e){var t=e.chats,a=e.selected,n=e.handleChatSelect;return r.a.createElement("ul",{className:"list"},t.map((function(e){var t=e.chatId,s=Object(p.a)(e,["chatId"]);return r.a.createElement(I,Object.assign({key:t,chatId:t,isSelected:t===a,handleChatSelect:n},s))})))}),S=(a(61),a(62),function(e){var t=Object(f.cn)("message"),a=e.text,n=e.timestamp,s=e.startsSequence,c=e.author,o=e.isOwn,i=t({own:o});return r.a.createElement("div",{className:i},r.a.createElement("div",{className:"message__balloon"},s&&!o&&r.a.createElement("div",{className:"message__author"},c),r.a.createElement("div",{className:"message__content"},a),r.a.createElement("div",{className:"message__info"},r.a.createElement("div",{className:"message__date"},n))))}),k=a(30),M=a(31),P=a(20),A=function(e){var t,a,n=D(e).slice(-1)[0];return{text:null!==(t=null===n||void 0===n?void 0:n.text)&&void 0!==t?t:"",timestamp:null!==(a=null===n||void 0===n?void 0:n.timestamp)&&void 0!==a?a:""}},D=function(e){return M[e]},J=(a(63),function(e){var t=e.messages;return r.a.createElement("div",{className:"chat"},function(){for(var e=[],a=P,n=0;n<t.length;n++){var s=t[n-1],c=t[n],o=!0,i=!0,l=c.messageId,u=c.text,d=c.timestamp,m=c.author;if(s)_.a.duration(_()(c.timestamp).diff(s.timestamp)).as("days")<1&&(o=!1),c.author===s.author&&(i=!1);var h=_()(d).isSame(_()(),"day");if(o){var b=h?"\u0421\u0435\u0433\u043e\u0434\u043d\u044f":_()(d).format("DD MMMM Y");e.push(r.a.createElement("div",{key:d,className:"timestamp"},b))}var p="a2d451ac-1c55-49ee-95e4-a1eca43520c7"===c.author,f=p?"\u0412\u044b":a[m];e.push(r.a.createElement(S,{key:l,text:u,timestamp:_()(d).format("h:mm"),isOwn:p,startsSequence:i,author:f}))}return e}())}),K=(a(64),a(65),function(e){e.style.height="inherit";var t=e.scrollHeight;e.style.height="".concat(t,"px")}),T=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={text:""},e.handleKeyPress=function(t){t.shiftKey||13!==t.which||(t.preventDefault(),e.state.text&&(e.props.handlePushMessage(e.state.text),e.setState({text:""})))},e.handleChange=function(t){e.setState({text:t.target.value}),K(t.target)},e}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"compose"},r.a.createElement("textarea",{className:"message-editor",rows:1,placeholder:"\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",autoComplete:"false",onKeyPress:this.handleKeyPress,onChange:this.handleChange,value:this.state.text}))}}]),a}(n.PureComponent),Z=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={messages:[],chats:[],selected:e.props.match.params.chatId},e.handlePushMessage=function(t){e.setState((function(e){return{messages:[].concat(Object(j.a)(e.messages),[{messageId:Object(N.a)(),text:t,timestamp:_()().format(),author:"a2d451ac-1c55-49ee-95e4-a1eca43520c7"}])}}))},e.handleChatSelect=function(t){return function(){e.setState({messages:D(t),selected:t}),e.props.history.push("/chat/".concat(t))}},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({chats:k.map((function(e){var t=e.chatId,a=e.users.map((function(e){return P[e]})),n=A(t);return Object(b.a)({chatId:t,name:a.join(", ")},n)})),messages:this.state.selected?D(this.state.selected):[]})}},{key:"render",value:function(){return r.a.createElement("div",{className:"layout"},r.a.createElement("div",{className:"sidebar"},r.a.createElement(x,{chats:this.state.chats,selected:this.state.selected,handleChatSelect:this.handleChatSelect})),r.a.createElement("div",{className:"main"},this.state.selected&&r.a.createElement(r.a.Fragment,null,r.a.createElement(J,{messages:this.state.messages}),r.a.createElement(T,{handlePushMessage:this.handlePushMessage}))))}}]),a}(n.PureComponent),q=function(e){var t=e.isAuthenticated,a=Object(p.a)(e,["isAuthenticated"]);return t?r.a.createElement(m.b,a):r.a.createElement(m.a,{to:"/auth"})},z=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={fields:{login:"",password1:"",password2:"",name:""},errors:{}},e.setError=function(t,a){e.setState((function(e){return{errors:Object(b.a)(Object(b.a)({},e.errors),{},Object(h.a)({},t,a))}}))},e.unsetError=function(t){e.setState((function(e){var a=Object(b.a)({},e.errors);return delete a[t],{errors:a}}))},e.handleInputChange=function(t){var a=t.target,n=a.name,r=a.value;e.unsetError(n),e.setState((function(e){return{fields:Object(b.a)(Object(b.a)({},e.fields),{},Object(h.a)({},n,r))}}))},e.validateLogin=function(){"demo"===e.state.fields.login&&e.setError("login","\u041b\u043e\u0433\u0438\u043d \u0443\u0436\u0435 \u0437\u0430\u043d\u044f\u0442")},e.handleSubmit=function(t){if(t.preventDefault(),0===Object.keys(e.state.errors).length){var a=e.props,n=a.history,r=a.submitCallback,s=e.state.fields;s.password1!==s.password2?e.setError("password2","\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 \u043f\u0430\u0440\u043e\u043b\u0435\u043c"):(r("a2d451ac-1c55-49ee-95e4-a1eca43520c7"),n.push("/chat"))}},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.history;return r.a.createElement(y,{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-field"},r.a.createElement(v,{name:"name",type:"text",placeholder:"\u0418\u043c\u044f",onChange:this.handleInputChange,value:this.state.fields.name,error:"name"in this.state.errors?this.state.errors.name:"",required:!0})),r.a.createElement("div",{className:"form-field"},r.a.createElement(v,{name:"login",type:"text",placeholder:"\u041f\u0440\u0438\u0434\u0443\u043c\u0430\u0439\u0442\u0435 \u043b\u043e\u0433\u0438\u043d",onChange:this.handleInputChange,onBlur:this.validateLogin,value:this.state.fields.login,error:"login"in this.state.errors?this.state.errors.login:"",required:!0})),r.a.createElement("div",{className:"form-field"},r.a.createElement(v,{name:"password1",type:"password",placeholder:"\u041f\u0440\u0438\u0434\u0443\u043c\u0430\u0439\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",onChange:this.handleInputChange,value:this.state.fields.password1,error:"password1"in this.state.errors?this.state.errors.password1:"",required:!0})),r.a.createElement("div",{className:"form-field"},r.a.createElement(v,{name:"password2",type:"password",placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",onChange:this.handleInputChange,value:this.state.fields.password2,error:"password2"in this.state.errors?this.state.errors.password2:"",required:!0})),r.a.createElement("button",{className:"button",type:"submit"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),r.a.createElement("button",{className:"button button_view_pseudo",onClick:function(){e.push("/auth")}},"\u0412\u043e\u0439\u0442\u0438")))}}]),a}(n.PureComponent),L=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={isAuthenticated:!1,userId:""},e}return Object(l.a)(a,[{key:"authorize",value:function(e){this.setState({isAuthenticated:!0,userId:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(m.d,null,r.a.createElement(q,{path:"/chat",isAuthenticated:this.state.isAuthenticated,exact:!0,component:Z}),"} />",r.a.createElement(q,{path:"/chat/:chatId",isAuthenticated:this.state.isAuthenticated,exact:!0,component:Z}),r.a.createElement(m.b,{path:"/auth",exact:!0,render:function(t){return r.a.createElement(O,Object.assign({},t,{submitCallback:e.authorize.bind(e)}))}}),r.a.createElement(m.b,{path:"/registration",exact:!0,render:function(t){return r.a.createElement(z,Object.assign({},t,{submitCallback:e.authorize.bind(e)}))}}),r.a.createElement(m.a,{to:"/chat"}))}}]),a}(r.a.PureComponent);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(70);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,null,r.a.createElement(L,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[35,1,2]]]);
//# sourceMappingURL=main.c290a4d5.chunk.js.map